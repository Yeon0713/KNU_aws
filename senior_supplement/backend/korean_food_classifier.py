#!/usr/bin/env python3
"""
한국 음식 정교한 분류 시스템
"""

class KoreanFoodClassifier:
    def __init__(self):
        self.food_database = {
            # 김치류 세분화
            "김치류": {
                "배추김치": {
                    "특징": ["빨간 양념", "배추잎 모양", "길쭉한 잎사귀", "하얀 배추 줄기"],
                    "구분점": "배추의 하얀 줄기 부분이 보이고 잎사귀가 길쭉함"
                },
                "깍두기": {
                    "특징": ["정사각형 모양", "무 조각", "빨간 양념", "깍둑썰기"],
                    "구분점": "정사각형으로 깍둑썰기된 무 조각이 특징"
                },
                "총각김치": {
                    "특징": ["작은 무", "잎과 뿌리 함께", "길쭉한 모양", "초록 잎"],
                    "구분점": "작은 무의 잎과 뿌리가 함께 있음"
                },
                "오이소박이": {
                    "특징": ["오이 모양", "초록색", "속이 빨간 양념", "반으로 갈라짐"],
                    "구분점": "오이를 반으로 갈라 속에 양념을 넣은 모양"
                }
            },
            
            # 국물류 세분화
            "국물류": {
                "된장국": {
                    "특징": ["갈색 탁한 국물", "두부", "파", "양파", "된장 색깔"],
                    "구분점": "갈색이고 탁한 국물, 미역이 없음"
                },
                "미역국": {
                    "특징": ["맑은 국물", "검은 미역", "미역 잎사귀", "소고기 또는 멸치"],
                    "구분점": "검은색 미역 잎사귀가 떠다니는 맑은 국물"
                },
                "김치찌개": {
                    "특징": ["빨간 국물", "김치 조각", "돼지고기", "두부", "매운맛"],
                    "구분점": "빨간색 매운 국물에 김치가 들어있음"
                },
                "순두부찌개": {
                    "특징": ["빨간 국물", "하얀 순두부", "부드러운 두부", "계란"],
                    "구분점": "빨간 국물에 하얀 순두부 덩어리"
                },
                "콩나물국": {
                    "특징": ["맑은 국물", "하얀 콩나물", "파", "마늘"],
                    "구분점": "맑은 국물에 하얀 콩나물만 들어있음"
                }
            },
            
            # 볶음류 세분화
            "볶음류": {
                "오징어콩나물볶음": {
                    "특징": ["하얀 콩나물", "오징어 링/조각", "양파", "당근"],
                    "구분점": "콩나물과 오징어가 함께 볶인 것"
                },
                "콩나물볶음": {
                    "특징": ["하얀 콩나물", "파", "마늘", "오징어 없음"],
                    "구분점": "콩나물만 볶은 것, 오징어 없음"
                },
                "오징어볶음": {
                    "특징": ["오징어 링/조각", "양파", "당근", "콩나물 없음"],
                    "구분점": "오징어만 볶은 것, 콩나물 없음"
                },
                "제육볶음": {
                    "특징": ["돼지고기", "양파", "고추", "빨간 양념"],
                    "구분점": "돼지고기를 매콤하게 볶은 것"
                }
            },
            
            # 나물류 세분화
            "나물류": {
                "시금치나물": {
                    "특징": ["짙은 녹색", "잎채소", "참기름 윤기", "마늘"],
                    "구분점": "짙은 녹색 잎채소, 참기름으로 무친 것"
                },
                "콩나물무침": {
                    "특징": ["하얀 콩나물", "파", "마늘", "참기름"],
                    "구분점": "하얀 콩나물을 무친 것"
                },
                "도라지무침": {
                    "특징": ["하얀색", "가늘고 긴 모양", "쫄깃한 식감"],
                    "구분점": "하얀색 가늘고 긴 도라지"
                },
                "미역줄기볶음": {
                    "특징": ["갈색 미역줄기", "당근", "양파", "볶은 것"],
                    "구분점": "갈색 미역줄기를 볶은 것"
                }
            },
            
            # 밥류 세분화
            "밥류": {
                "흰밥": {
                    "특징": ["하얀 쌀알", "윤기", "찰기"],
                    "구분점": "순수한 하얀 쌀밥"
                },
                "현미밥": {
                    "특징": ["갈색 쌀알", "거친 질감", "영양밥"],
                    "구분점": "갈색빛이 도는 현미 쌀알"
                },
                "잡곡밥": {
                    "특징": ["여러 색깔", "콩", "보리", "수수"],
                    "구분점": "여러 색깔의 곡물이 섞인 밥"
                }
            },
            
            # 반찬류 세분화
            "반찬류": {
                "계란말이": {
                    "특징": ["노란색", "말린 모양", "계란", "부드러운 질감"],
                    "구분점": "노란 계란을 말아서 만든 것"
                },
                "멸치볶음": {
                    "특징": ["작은 멸치", "갈색", "견과류", "달콤짠맛"],
                    "구분점": "작은 멸치를 볶아서 만든 것"
                },
                "어묵볶음": {
                    "특징": ["어묵", "양파", "당근", "간장 색깔"],
                    "구분점": "어묵을 채썰어서 볶은 것"
                }
            }
        }
    
    def get_detailed_classification_prompt(self):
        """상세한 한국 음식 분류 프롬프트 생성"""
        prompt = """
당신은 한국 음식 전문 분류사입니다. 다음 세부 분류 기준을 정확히 따라주세요:

=== 김치류 정교한 구분 ===
• 배추김치: 배추의 하얀 줄기 + 길쭉한 잎사귀 + 빨간 양념
• 깍두기: 정사각형 깍둑썰기 무 조각 + 빨간 양념
• 총각김치: 작은 무 + 초록 잎과 뿌리 함께
• 오이소박이: 오이를 반으로 갈라 속에 빨간 양념

=== 국물류 정교한 구분 ===
• 된장국: 갈색 탁한 국물 + 두부/파 (미역 없음)
• 미역국: 맑은 국물 + 검은 미역 잎사귀
• 김치찌개: 빨간 매운 국물 + 김치 조각
• 순두부찌개: 빨간 국물 + 하얀 순두부 덩어리
• 콩나물국: 맑은 국물 + 하얀 콩나물만

=== 볶음류 정교한 구분 ===
• 오징어콩나물볶음: 콩나물 + 오징어 함께
• 콩나물볶음: 콩나물만 (오징어 없음)
• 오징어볶음: 오징어만 (콩나물 없음)

=== 나물류 정교한 구분 ===
• 시금치나물: 짙은 녹색 잎채소 + 참기름 윤기
• 콩나물무침: 하얀 콩나물 + 무친 것
• 도라지무침: 하얀색 가늘고 긴 도라지
• 미역줄기볶음: 갈색 미역줄기 + 볶은 것

**분석 방법:**
1. 색깔을 먼저 정확히 관찰
2. 모양과 크기 확인 (깍둑썰기, 길쭉함, 둥글음 등)
3. 재료 조합 확인 (함께 들어있는 것들)
4. 조리법 추정 (볶음, 무침, 국물 등)

**절대 규칙:**
- 정사각형 모양이면 깍두기, 길쭉하면 배추김치
- 콩나물+오징어 함께면 오징어콩나물볶음
- 갈색 탁한 국물이면 된장국, 맑은 국물+검은 미역이면 미역국
"""
        return prompt
    
    def get_verification_questions(self):
        """검증 질문들"""
        return [
            "이 음식의 주요 색깔은 무엇인가요?",
            "어떤 모양으로 썰려있나요? (깍둑썰기, 채썰기, 길쭉함 등)",
            "함께 들어있는 다른 재료는 무엇인가요?",
            "국물이 있다면 맑은가요 탁한가요?",
            "조리 방법은 무엇으로 보이나요? (볶음, 무침, 끓임 등)"
        ]

# 전역 인스턴스
korean_classifier = KoreanFoodClassifier()